# 二维码生成打印工具 - 使用指南

## 📋 功能概述

本工具是一个专业的二维码生成和打印管理系统，专为物料管理和库存标签打印场景设计，支持批量处理、Excel数据导入导出，并针对斑马打印机进行了优化。

## 🚀 快速开始

### 1. 导入物料数据

#### 方式一：Excel批量导入
1. 点击顶部操作栏的"导入"按钮
2. 选择符合模板格式的Excel文件
3. 系统会自动解析并导入数据

#### Excel模板格式
| 列名 | 说明 | 示例 |
|------|------|------|
| 料桶码 | 物料容器编号 | 285A210115 |
| 料品批次 | 批次号 | 2024030601 |
| 托盘码 | 托盘编号 | 285A210115-18 |
| 料品编码 | 物料编号 | 300100-00204 |
| 规格型号 | 规格说明 | HV-8-SBH |
| 料品批次编码规则 | 编码规则说明 | 供应商字母编号+批次号+流水号 |

### 2. 数据管理

#### 查询和筛选
- 使用搜索框输入关键词（支持物料编号、名称、料桶码、托盘码等）
- 点击"查询"按钮进行搜索
- 点击"刷新"按钮重新加载所有数据

#### 编辑数据
1. 勾选需要编辑的数据行（仅支持单条编辑）
2. 点击"修改"按钮
3. 在弹出的对话框中修改信息
4. 点击"保存"完成修改

#### 删除数据
1. 勾选需要删除的数据行（支持多选）
2. 点击"删除"按钮
3. 确认删除操作

#### 批次和料桶锁定
- 点击数据行操作列的锁定图标可以锁定/解锁批次或料桶
- 锁定后的数据会显示锁定标识

### 3. 打印标签

#### 🔧 重要说明：Web浏览器打印限制

由于浏览器安全策略，Web应用无法直接连接网络打印机。请使用以下推荐方法：

#### ✅ 方法一：下载ZPL文件打印（推荐）

**单个标签打印：**
1. 点击数据行操作列的打印图标
2. 在打印预览对话框中查看标签效果
3. 点击"下载ZPL"按钮，保存ZPL文件到本地
4. 使用打印工具发送ZPL文件到打印机

**批量标签打印：**
1. 勾选需要打印的多条数据
2. 点击"批量下载ZPL"按钮
3. 系统会生成包含所有标签的ZPL文件
4. 使用打印工具批量发送到打印机

**发送ZPL文件到打印机的工具：**
- **Zebra Setup Utilities**（官方工具，推荐）
- **ZebraDesigner**（设计软件）
- **命令行工具**：
  ```bash
  # Windows
  copy /b file.zpl \\打印机IP\共享名
  
  # Linux/Mac
  cat file.zpl | nc 打印机IP 9100
  ```

#### 方法二：使用Zebra Browser Print

1. 下载并安装Zebra Browser Print客户端程序
   - 下载地址：[Zebra官网](https://www.zebra.com/us/en/support-downloads/software/printer-software/browser-print.html)
2. 运行Browser Print服务
3. 在本工具中配置打印机（点击"打印机配置"）
4. 配置完成后，可以直接点击"发送打印"按钮

### 4. 打印机配置

1. 点击右上角"打印机配置"按钮
2. 填写打印机信息：
   - **打印机名称**：例如 ZDesigner ZD888-203dpi ZPL
   - **打印机类型**：选择斑马打印机
   - **打印机IP地址**：例如 172.16.5.199
   - **打印机端口**：默认 9100
3. 点击"测试连接"验证配置（仅验证配置格式）
4. 点击"保存配置"

### 5. 数据导出

1. 勾选需要导出的数据（不勾选则导出全部）
2. 点击"导出"按钮
3. 系统会生成Excel文件并自动下载

## 📊 标签内容说明

每个打印标签包含以下信息：
- **标题**：圣宝鸿料桶标签
- **料桶码**：物料容器编号
- **料品批次**：批次号
- **托盘码**：托盘编号
- **料品编码**：物料编号
- **料品名称**：物料名称
- **规格型号**：规格说明
- **二维码**：包含以上关键信息的二维码

## 🔍 查看ZPL代码

在打印预览对话框中：
1. 切换到"ZPL代码"标签页
2. 可以查看完整的ZPL打印代码
3. 点击"复制代码"可以复制到剪贴板
4. 可用于调试或自定义修改

## ⚙️ 打印机技术参数

根据您提供的打印机配置信息：

- **打印机型号**：ZDesigner ZD888-203dpi
- **打印协议**：ZPL II
- **分辨率**：203 DPI (8点/毫米)
- **打印宽度**：639点
- **标签长度**：494点
- **打印速度**：6.0 IPS
- **打印模式**：TEAR OFF（撕离模式）
- **介质类型**：GAP/NOTCH（间隙/缺口）
- **打印方式**：热转印（THERMAL-TRANS）
- **通信方式**：USB / 网络

## 💡 使用技巧

1. **批量操作**：使用表头的复选框可以快速全选/取消全选
2. **快速搜索**：在搜索框中输入后按Enter键即可搜索
3. **状态标识**：
   - 绿色徽章：正常状态
   - 灰色徽章：待检状态
   - 红色徽章：异常状态
4. **锁定功能**：锁定后的批次或料桶会显示锁定图标，防止误操作

## ❓ 常见问题

### Q1: 为什么无法直接打印？
A: 由于浏览器安全限制，Web应用无法直接连接网络打印机。请使用"下载ZPL"方式，或安装Zebra Browser Print客户端程序。

### Q2: Excel导入失败怎么办？
A: 请确保Excel文件格式正确，列名与模板一致。检查是否有特殊字符或格式问题。

### Q3: 打印出来的标签内容不完整？
A: 请检查打印机设置，确保标签尺寸配置正确。可以在ZPL代码中调整坐标和字体大小。

### Q4: 如何修改标签样式？
A: 标签样式由ZPL代码控制，可以在打印预览中查看ZPL代码，复制后使用ZebraDesigner等工具进行修改。

### Q5: 数据会保存在哪里？
A: 所有数据都保存在云端数据库中，可以随时访问和管理。

## 📞 技术支持

如有其他问题，请联系系统管理员或技术支持团队。
