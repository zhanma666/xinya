# 二维码生成打印工具 - 使用指南

## 📋 目录

1. [快速开始](#快速开始)
2. [功能介绍](#功能介绍)
3. [打印方法](#打印方法)
4. [常见问题](#常见问题)

---

## 🚀 快速开始

### 第一步：导入物料数据

1. 点击页面上的 **"导入"** 按钮
2. 选择准备好的 Excel 文件（支持 .xlsx 和 .xls 格式）
3. 系统会自动解析并导入数据

**Excel 文件格式要求：**

| 列名 | 说明 | 是否必填 |
|------|------|----------|
| 料桶码 | 物料桶编号 | 必填 |
| 料品批次 | 批次号 | 必填 |
| 托盘码 | 托盘编号 | 可选 |
| 料品编码 | 物料编码 | 必填 |
| 规格型号 | 规格说明 | 可选 |

### 第二步：配置打印机

1. 点击右上角的 **"打印机配置"** 按钮
2. 填写打印机信息：
   - **打印机名称**：ZDesigner ZD888-203dpi ZPL（默认）
   - **打印机类型**：斑马打印机（默认）
   - **打印机IP地址**：172.16.5.199（根据实际情况修改）
   - **打印机端口**：9100（默认）
3. 点击 **"测试连接"** 验证配置
4. 点击 **"保存"** 保存配置

### 第三步：打印标签

#### 方法一：单个打印
1. 在物料列表中找到需要打印的物料
2. 点击该行右侧的 **打印机图标** 按钮
3. 在预览对话框中查看标签效果
4. 点击 **"下载ZPL"** 下载打印文件
5. 使用打印工具发送到打印机

#### 方法二：批量打印
1. 勾选需要打印的多个物料
2. 点击 **"批量下载ZPL"** 按钮
3. 系统会生成包含所有标签的 ZPL 文件
4. 使用打印工具批量发送到打印机

---

## 🎯 功能介绍

### 1. 物料数据管理

#### 查看物料列表
- 列表显示所有导入的物料信息
- 包含：原材来料编号、物料编号、物料名称、规格型号、托盘码、料桶码、料品状态、来料批次、供应商名等

#### 搜索物料
1. 在搜索框中输入关键词
2. 支持搜索：物料编号、名称、料桶码、托盘码
3. 点击 **"查询"** 按钮执行搜索
4. 点击 **"刷新"** 按钮重置搜索

#### 编辑物料
1. 勾选一条物料记录
2. 点击 **"修改"** 按钮
3. 在弹出的对话框中修改信息
4. 点击 **"保存"** 提交修改

#### 删除物料
1. 勾选需要删除的物料（可多选）
2. 点击 **"删除"** 按钮
3. 确认删除操作

### 2. 批次和料桶管理

#### 锁定/解锁批次
- 点击物料行右侧的 **锁图标** 按钮
- 锁定后的批次会显示锁定标识
- 再次点击可解锁

### 3. Excel 数据导入导出

#### 导入数据
1. 点击 **"导入"** 按钮
2. 选择 Excel 文件
3. 系统自动解析并导入
4. 导入成功后会显示导入的数据条数

#### 导出数据
1. 点击 **"导出"** 按钮
2. 可选择导出全部数据或仅导出选中的数据
3. 系统会生成 Excel 文件并自动下载

---

## 🖨️ 打印方法

### ⚠️ 重要提示

由于浏览器安全限制，Web 应用无法直接连接网络打印机。请使用以下方法之一进行打印。

### 方法一：使用 ZPL 文件打印（推荐）

#### 步骤：
1. 在本工具中点击 **"打印预览"**
2. 点击 **"下载ZPL"** 按钮，保存 ZPL 文件到本地
3. 使用以下任一工具发送 ZPL 文件到打印机

#### 工具选项：

**A. Zebra Setup Utilities（官方工具）**
- 下载地址：Zebra 官网
- 安装后打开软件
- 选择打印机
- 点击 "Send File" 发送 ZPL 文件

**B. 命令行工具（Windows）**
```cmd
copy /b 标签文件.zpl \\打印机IP\共享名
```

**C. 命令行工具（Linux/Mac）**
```bash
cat 标签文件.zpl | nc 打印机IP 9100
```

### 方法二：使用 Zebra Browser Print

#### 步骤：
1. 下载并安装 Zebra Browser Print
2. 运行 Browser Print 服务（会在后台运行）
3. 在本工具中配置打印机
4. 直接点击 **"发送打印"** 按钮

---

## ❓ 常见问题

### Q1: 为什么测试连接失败？

**A:** 这是正常现象。由于浏览器安全限制，Web 应用无法直接测试打印机连接。"测试连接"功能仅验证配置信息是否完整。

**解决方案：**
- 确保打印机 IP 地址正确
- 确保打印机和电脑在同一网络
- 使用下载 ZPL 文件的方式打印

### Q2: 导入 Excel 失败怎么办？

**A:** 请检查以下几点：
1. Excel 文件格式是否正确（.xlsx 或 .xls）
2. 必填字段是否都有数据
3. 文件是否损坏

### Q3: 如何修改标签样式？

**A:** 标签样式由 ZPL 代码控制，如需修改：
1. 在打印预览中切换到 "ZPL代码" 标签页
2. 复制 ZPL 代码
3. 使用 ZebraDesigner 或其他工具编辑
4. 保存修改后的 ZPL 文件

### Q4: 数据会保存在哪里？

**A:** 所有数据保存在云端数据库中：
- 自动保存，无需手动操作
- 支持多设备访问
- 数据安全可靠

### Q5: 如何备份数据？

**A:** 使用导出功能：
1. 点击 **"导出"** 按钮
2. 下载 Excel 文件
3. 定期备份到本地或云盘

---

**祝您使用愉快！** 🎉
